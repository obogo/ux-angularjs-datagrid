/*!
* ux-angularjs-datagrid v.1.6.12
* (c) 2018, Obogo
* https://github.com/obogo/ux-angularjs-datagrid
* License: MIT.
*/
(function (exports, global) {
if (typeof define === "function" && define.amd) {
  define(exports);
} else if (typeof module !== "undefined" && module.exports) {
  module.exports = exports;
} else {
  global.ux = exports;
}


!function(a,b){function c(b,c,d){var e,f,g,h=0,i=a.util.apply;if(arguments.length>2&&(g=a.util.array.toArray(arguments),g.splice(0,2)),b&&b.length)for(e=b.length;h<e;){if(void 0!==(f=i(c,null,[b[h],h,b].concat(g))))return f;h+=1}else if(b&&i(Object.prototype.hasOwnProperty,b,["0"]))for(;i(Object.prototype.hasOwnProperty,b,[h]);){if(void 0!==(f=i(c,null,[b[h],h,b].concat(g))))return f;h+=1}else if(!(b instanceof Array))for(h in b)if(i(Object.prototype.hasOwnProperty,b,[h])&&void 0!==(f=i(c,null,[b[h],h,b].concat(g))))return f;return b}function d(b,c,d){var e,f,g,h=0,i=[],j=a.util.apply;if(arguments.length>2&&(f=a.util.array.toArray(arguments),f.splice(0,2)),b&&b.length)for(e=b.length;h<e;)g=j(c,null,[b[h],h,b].concat(f)),g&&i.push(b[h]),h+=1;else for(h in b)j(Object.prototype.hasOwnProperty,b,[h])&&(g=j(c,null,[b[h],h,b].concat(f)))&&i.push(b[h]);return i}function e(b,c){for(var d,f,g=a.util.array.toArray(arguments),h=1,i=g.length;h<i;){d=g[h];for(f in d)b[f]&&"object"==typeof b[f]?b[f]=e(b[f],d[f]):d[f]instanceof Array?b[f]=e([],d[f]):d[f]&&"object"==typeof d[f]?b[f]=e({},d[f]):b[f]=d[f];h+=1}return b}function f(b,c,d,e){function f(a){return a.toString().split(/\b/)[2]}function g(a,b,c){return{label:f(a),method:a,args:b||[],delay:c}}function h(a){var b=f(a);J[b]=a}function i(a){for(var c=1,e=G.length;c<e;)G[c].label===a.label&&(G[c]===F&&B?(d.cancel(B),B=null,F=null,b.warn("REMOVE ACTIVE FLOW ITEM %c%s",L,a.label)):b.info("remove Flow item %c%s",L,a.label),G.splice(c,1),c-=1,e-=1),c+=1;F||s()}function j(a,c,d){var e=g(a,c,d);b.info("add",e.label),J[e.label]&&i(e),G.push(e),E&&s()}function k(a,b,c){G.splice(1,0,g(a,b,c))}function l(a){i({label:f(a)})}function m(a,c){var d,e=g(a,[]),f=Date.now(),h=function(){b.log("exec timeout method %c%s %sms (len:%s)",L,e.label,Date.now()-f,G.length),G.push(e),E&&s()};return b.log("wait for timeout method %c%s (len:%s)",L,e.label,G.length),d=setTimeout(h,c),K[d]=function(){clearTimeout(d),delete K[d]},d}function n(a){K[a]&&K[a]()}function o(a){return a.toString().match(/\(.*\)/)[0].match(/([\$\w])+/gm)}function p(a){var b=o(a);return!(!b||-1===b.indexOf("done"))}function q(){return A=Date.now(),b.log("\tfinish %c%s took %dms (len:%s)",L,F.label,A-z,G.length),F=null,r(G.shift()),s(),A-z}function r(a){for(H.unshift(a);H.length>I;)H.pop()}function s(){b.log("next %s",G.length),b.lifespan=D=Date.now()-C,!F&&G.length?(M=0,F=G[0],b.async&&void 0!==F.delay?(b.log("\tdelay for %c%s %sms (len:%s)",L,F.label,F.delay,G.length),B=d(t,F.delay,!1)):t()):F&&G.length&&F.label===G[0].label&&(b.info("\tskip",F.label),M>100&&(b.warn("Exceeded max repeat of 100 iterations on the same method. Dropping Method."),G.shift()),M+=1)}function t(){if(b){if(B&&d.cancel(B),c&&c())return b.warn("\twait for pauseFn"),void(B=d(t,0,!1));var e=p(F.method);b.log("start method %c%s (len:%s)"+(e&&" - (has done arg)"||""),L,F.label,G.length),e&&F.args.push(q);try{z=Date.now(),a.util.apply(F.method,null,F.args)}catch(a){b.warn(a.message+"\n"+(a.stack||a.stacktrace||a.backtrace))}finally{e||q()}}}function u(){E=!0,s()}function v(){var a,c=F?1:0;for(b.info("clear");G.length>c;)a=G.splice(c,1)[0],b.log("\tremove %s from flow",a.label)}function w(){return G.length}function x(a){for(var b=0,c=0;c<G.length;c+=1)(a instanceof Array&&-1!==a.indexOf(G[c].label)||G[c].label===a)&&(b+=1);return b}function y(){G.length=0,b=null}var z,A,B,C=Date.now(),D=0,E=!1,F=null,G=[],H=[],I=10,J={},K={},L="color:#666666;",M=0;return a.logWrapper("Flow",b,"grey",e||b),b.debug=a.util.apply(Object.prototype.hasOwnProperty,b,["debug"])?b.debug:0,b.insert=k,b.add=j,b.unique=h,b.remove=l,b.timeout=m,b.stopTimeout=n,b.run=u,b.clear=v,b.length=w,b.count=x,b.destroy=y,b}function g(b,d,e,g,h){function i(){Ga.unique(ya),Ga.unique(na),Ga.unique(da),Ga.unique(va),Ga.unique(xa)}function j(){Ya.uid=a.uid(),Ya.name=b.$eval(e.gridName)||"datagrid",Ya.scope=b,Ya.element=d,Ya.attr=e,Ya.rowsLength=0,Ya.scopes=Oa,Ya.data=Ya.data||[],Ya.unwatchers=Na,Ya.values=Wa,Ya.start=o,Ya.update=oa,Ya.reset=ya,Ya.isReady=w,Ya.isStartupComplete=r,Ya.forceRenderScope=za,Ya.dispatch=Ca,Ya.activateScope=$,Ya.deactivateScope=Z,Ya.updateLinks=ga,Ya.render=function(){Ga.add(na)},Ya.updateHeights=Ba,Ya.getOffsetIndex=aa,Ya.isActive=_,Ya.isCompiled=F,Ya.swapItem=z,Ya.moveItem=A,Ya.getScope=B,Ya.getRowItem=C,Ya.getRowElm=D,Ya.getExistingRow=E,Ya.getRowIndex=Ya.getIndexOf=G,Ya.getRowOffset=I,Ya.getRowHeight=J,Ya.getViewportHeight=K,Ya.getContentHeight=L,Ya.getContent=n,Ya.isDigesting=S,Ya.safeDigest=T,Ya.getRowIndexFromElement=H,Ya.updateViewportHeight=v,Ya.calculateViewportHeight=x,Ya.options=Ja=a.extend({},a.datagrid.options,b.$eval(e.options)||{}),Ya.flow=Ga=new f({async:!a.util.apply(Object.prototype.hasOwnProperty,Ja,["async"])||!!Ja.async,debug:a.util.apply(Object.prototype.hasOwnProperty,Ja,["debug"])?Ja.debug:0},S,h,Ya.options.debug&&Ya.options.debug.Flow?Ya:null),Ya.grouped=b.$eval(e.grouped),Ya.gc=Da,Ya.throwError=a.datagrid.throwError,Ga.add(i),Ga.run()}function k(){var b,c=d[0].getElementsByClassName(Ja.contentClass),e=Ja.contentClass;return c=a.filter(c,m),b=c[0],b&&(e=b.className||Ja.contentClass),b||(e=l()||e,b=angular.element('<div class="'+e+'"></div>'),Ya.options.chunks.detachDom&&(b[0].style.position="relative"),d.prepend(b)),b[0]||(b=angular.element(b)),b}function l(){var b,c;if(Ia)return b=a.util.array.toArray(Ia[0].classList),c=b.indexOf("old-"+Ja.contentClass),-1!==c&&b.splice(c,1),b.join(" ")}function m(a,b,c){return!angular.element(a).hasClass("old-"+Ja.contentClass)}function n(){return Ha}function o(){Ya.dispatch(a.datagrid.events.ON_INIT,Ya),Ha=k(),p(0)}function p(a){if(!Ya.element[0].offsetHeight){if(a<1)return void Ga.add(p,[a+1],0);Ga.warn("Datagrid: DOM Element does not have a height.")}Ja.templateModel&&Ja.templateModel.templates&&Ga.add(Ya.templateModel.createTemplatesFromData,[Ja.templateModel.templates],0),Ga.add(Ya.templateModel.createTemplates,null,0),Ga.add(function(){Ja.dynamicRowHeights=Ya.templateModel.dynamicHeights()}),Ga.add(q)}function q(){var c=b.$on(a.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE,function(){c(),Ga.add(s)});window.addEventListener("resize",y),Na.push(b.$on(a.datagrid.events.UPDATE,oa)),Na.push(b.$on(a.datagrid.events.ON_ROW_TEMPLATE_CHANGE,Aa)),Na.push(b.$on("$destroy",Fa)),Ga.add(t,[],0),Ya.dispatch(a.datagrid.events.ON_LISTENERS_READY)}function r(){return $a}function s(){$a=!0,Ca(a.datagrid.events.ON_STARTUP_COMPLETE,Ya)}function t(){if(!Ma){Ya.log("setupChangeWatcher"),Ma=!0,Na.push(b.$watchCollection(e.uxDatagrid,u));var a=b.$eval(e.uxDatagrid);a&&a.length&&Ga.add(na)}}function u(a,b){Ya.info("\tonDataChangeFromWatcher |"+Ga.lifespan+"| new:"+(a&&a.length||0)+" old:"+(b&&b.length||0)),Ga.add(va,[a,b,Ga.lifespan])}function v(){(Sa=Ya.calculateViewportHeight())||(Sa=Ja.minHeight)}function w(){return Va===Ta.READY}function x(){return d[0].offsetHeight}function y(a){pa()}function z(b,c,d){var e,f,g=G(b);a.util.apply(Object.prototype.hasOwnProperty,Ya.data,[g])&&(e=Ya.templateModel.getTemplate(b),f=d?e:Ya.templateModel.getTemplate(c),Ya.normalizeModel.replace(c,g),e!==f?Ya.templateModel.setTemplate(g,f.name):(Oa[g][f.item]=c,T(Oa[g])))}function A(a,b){Ya.normalizeModel.move(a,b),xa(Ya.getOriginalData(),Ya.getOriginalData())}function B(a){return Oa[a]}function C(a){return this.getData()[a]}function D(a){return angular.element(Ya.chunkModel.getRow(a))}function E(a){return angular.element(Ya.chunkModel.getExistingRow(a))}function F(a){return!!Oa[a]}function G(a){return Ya.getNormalizedIndex(a,0)}function H(a){if(d){if(a&&d[0].contains(a[0]||a)){a=a.scope?a:angular.element(a);var b=a.scope();for(b===Ya.scope&&Ya.throwError("Unable to get row scope... something went wrong.");b&&b.$parent&&b.$parent!==Ya.scope;)b=b.$parent;if(void 0===b.$index){for(Ga.warn("Unable to get Index from row scope. Row scope is not activated or not compiled to that row.");a.length&&!a[0].getAttribute("row-id")&&a[0]!==d[0];)a=a.parent();return parseInt(a[0].getAttribute("row-id"),10)}return b.$index}if(a&&a.attr){for(;a&&void 0===a.attr("row-id")&&a[0]!==Ya.element[0]&&a[0]!==document.body;)a=a.parent();return parseInt(a.attr("row-id"),10)}}return-1}function I(a){return void 0===Ra[a]&&(Ja.dynamicRowHeights?ca():Ra[a]=a*Ja.rowHeight),Ra[a]}function J(a){return Ya.templateModel.getRowHeight(a)}function K(){return Sa}function L(){var a=Ya&&Ya.chunkModel&&Ya.chunkModel.getChunkList()||[];return a&&a.height||0}function M(a){Ya.log("OVERWRITE DOM!!!");var b=a.length;Ya.chunkModel.chunkDom(a,Ja.chunks.size,'<div class="'+Ja.chunks.chunkClass+'">',"</div>",Ha),Ya.rowsLength=b,Ya.log("created %s dom elements",b)}function N(a,c){var d,e=Oa[a];return e&&!e.$parent&&(e.$parent=b),e?e&&(d=E(a)).scope()!==e&&O(e,a,d):(!b.$$childTail&&b.$$childHead&&Oa[a-1]&&(b.$$childTail=Oa[a-1]),e=b.$new(),O(e,a,c)),e}function O(b,c,d){var e,f,h;e=Ya.templateModel.getTemplateName(Ya.data[c]),f=Ya.templateModel.getTemplate(Ya.data[c]),e=e||f.name,b=b||B(c),Oa[c]=b,b.$status=Ja.compiledClass,b[f.item]=Ya.data[c],b.$index=c,d=d||D(c),d.removeClass(Ja.uncompiledClass),h=_a[e]||(_a[e]=g(d)),h(b,function(a){var e=Ya.chunkModel.getRowIndexes(c);e.pop();for(var f=Ya.chunkModel.getItemByIndexes(e).dom,g=d[0].attributes,h=g.length,i=0;i<h;i+=1){var j=g[i];"class"===j.name||a.attr(j.name)===j.value||void 0===j.value||"style"===j.name&&!j.value||a.attr(j.name,j.value)}f.replaceChild(a[0],d[0]),Z(b,c)}),Ya.templateModel.hasVariableRowHeights()&&Ya.chunkModel.updateAllChunkHeights(c),Ya.dispatch(a.datagrid.events.ON_ROW_COMPILE,b,d),Z(b,c)}function P(a,b){Ya.log("\tbuildRows %s",a.length),Va=Ta.BUILDING,M(a),Ga.add(ca,0),w()||Ga.add(Q),b&&Ga.add(na)}function Q(){Ya.log("\tready"),Va=Ta.READY,Ga.add(R),Ga.add(T,[b])}function R(){b.$emit(a.datagrid.events.ON_READY)}function S(a){for(var c=a||b;c;){if(c.$$phase)return!0;c=c.$parent}return!1}function T(a){return!S(a)&&(a.$digest(),!0)}function U(b,c,d){for(;b;){for(var e in c)a.util.apply(Object.prototype.hasOwnProperty,c,[e])&&d(b,c,e);b=b.$parent}}function V(a,b){U(a,b,W)}function W(a,b,c){a.$$listenerCount[c]+=b[c]}function X(a,b){U(a,b,Y)}function Y(a,b,c){a.$$listenerCount[c]-=b[c]}function Z(c,d){return!(!c||_(c))&&(c.$broadcast(a.datagrid.events.ON_BEFORE_ROW_DEACTIVATE),c.$$$watchers=c.$$watchers,c.$$watchers=[],c.$$$watchersCount=c.$$watchersCount,c.$$watchersCount=0,c.$$$listenerCount=angular.extend({},c.$$listenerCount),X(c,c.$$listenerCount),d>=0&&(c.$$prevSibling?c.$$prevSibling.$$nextSibling=null:c.$$nextSibling&&(c.$$nextSibling.$$prevSibling=null),c.$parent=b,c.$$nextSibling=null,c.$$prevSibling=null),!0)}function $(c,d,e){return c&&void 0!==c.$$$watchers?(c.$parent=b,c.$$watchers=c.$$$watchers,c.$$watchersCount=c.$$$watchersCount,delete c.$$$watchers,V(c,c.$$$listenerCount),delete c.$$$listenerCount,c.$broadcast(a.datagrid.events.ON_AFTER_ROW_ACTIVATE),!0):!(!c||c.$$$watchers)}function _(a){var b=Oa[a];return!(!b||b.$$$watchers)}function aa(a){var b=Math.floor(a/Ya.templateModel.averageTemplateHeight()),c=0,d=Ya.rowsLength;if(!a||Ya.rowsLength<2)return c;for(Ra[b]&&Ra[b]<=a&&(c=b);c<d;){if(Ra[c]<=a&&Ra[c+1]>a)return c;c+=1}return c}function ba(){Wa.dirty&&Ya.chunkModel.getChunkList()&&Ya.chunkModel.getChunkList().height-Ya.getViewportHeight()<Wa.scroll&&(Ya.info("Scroll reset because either there is no data or the scroll is taller than there is scroll area"),Wa.scroll=0);var b=Sa,c=Wa.scroll>=0?Wa.scroll:0,d={startIndex:0,i:0,inc:1,end:Ya.rowsLength,visibleScrollStart:c+Ja.cushion,visibleScrollEnd:c+b-Ja.cushion};return d.startIndex=d.i=Ya.getOffsetIndex(c),Ya.rowsLength&&d.startIndex===d.end&&(d.startIndex=d.i=d.end-1,Ya.log(a.errors.E1002)),d}function ca(){for(var a,b=0,c=0;c<Ya.rowsLength;)Ra[c]=b,b+=Ya.getRowHeight(c),c+=1;Ja.rowHeight=Ya.rowsLength?Ya.templateModel.getTemplateHeight("default"):0,a=L(),Ya.getContent()[0].style.height=a+"px",Ya.log("heights: viewport %s content %s",Ya.getViewportHeight(),a)}function da(){var c,d,e,f,g=ba(),h=[].concat(Pa),i=!1;if(!(g.i<0)){for(Ya.dispatch(Ua.ON_BEFORE_UPDATE_WATCHERS,g),ha(),Pa.length=0,Ya.log("\tscroll %s visibleScrollStart %s visibleScrollEnd %s",Wa.scroll,g.visibleScrollStart,g.visibleScrollEnd);g.i<Ya.rowsLength&&(b.$$childHead?Oa[g.i-1]:null,c=Ya.getRowOffset(g.i),(c>=g.visibleScrollStart&&c<=g.visibleScrollEnd||g.i===g.startIndex&&g.i<g.end)&&(e=N(g.i),void 0===g.started&&(g.started=g.i),ia(g.i),e.$$$watchers&&$(e,g.i,!0)?(f=Ya.getRowElm(g.i),f.attr("status","active"),d=h.indexOf(g.i),-1!==d&&h.splice(d,1),Pa.push(g.i),T(e)||(i=!0),e.$digested=!0):Pa.push(g.i)),g.i+=g.inc,!(g.inc>0&&c>g.visibleScrollEnd||g.inc<0&&c<g.visibleScrollStart)););g.ended=g.i-1,Ya.rowsLength&&Wa.activeRange.min<0&&Wa.activeRange.max<0&&Ya.throwError(a.errors.E1002),Ya.log("\tstartIndex %s endIndex %s",g.startIndex,g.i),fa(h),Qa=g.visibleScrollStart,Ya.log("\tactivated %s",Pa.join(", ")),ga(),Ya.templateModel.hasVariableRowHeights()&&ca(),Ga.add(ea,[g],0),i&&Ga.add(function(){T(b)})}}function ea(a){Ya.dispatch(Ua.ON_AFTER_UPDATE_WATCHERS,a)}function fa(a){for(var b,c=[];a.length;)b=a.pop(),-1===Pa.indexOf(b)&&(c.push(b),Z(Oa[b],b),Ya.getRowElm(b).attr("status","inactive"));Ya.log("\tdeactivated %s",c.join(", "))}function ga(){if(Pa.length){var a,c=Pa[Pa.length-1],d=0,e=Pa.length;for(d=0;d<e;d+=1)a=Oa[Pa[d]],a.$$prevSibling=Oa[Pa[d-1]],a.$$nextSibling=Oa[Pa[d+1]],a.$parent=b;b.$$childHead=Oa[Pa[0]],b.$$childTail=Oa[c]}}function ha(){Wa.activeRange.min=Wa.activeRange.max=-1}function ia(a){Wa.activeRange.min=Wa.activeRange.min<a&&Wa.activeRange.min>=0?Wa.activeRange.min:a,Wa.activeRange.max=Wa.activeRange.max>a&&Wa.activeRange.max>=0?Wa.activeRange.max:a}function ja(){Wa.dirty&&Ca(a.datagrid.events.ON_BEFORE_RENDER_AFTER_DATA_CHANGE)}function ka(){var b,c;Wa.dirty&&Wa.activeRange.max>=0&&(Wa.dirty=!1,b=Ya.templateModel.calculateRowHeight(D(Wa.activeRange.min)[0]),Ga.async&&Ya.getData().length&&b!==(c=Ya.templateModel.getRowHeight(Wa.activeRange.min))&&(window.console&&console.warn&&console.warn("Template height change from "+c+" to "+b+". This can cause gaps in the datagrid."),Ya.templateModel.updateTemplateHeights()),Ca(a.datagrid.events.ON_RENDER_AFTER_DATA_CHANGE))}function la(){Ga.add(Ya.updateViewportHeight,null,La),Ga.add(na)}function ma(){return v(),Sa?(La&&Ya.info("datagrid has height of %s.",Sa),La=0,!0):(La+=1,La<Ya.options.readyToRenderRetryMax?(Ya.info("datagrid is waiting for element to have a height."),la()):Ga.warn("Datagrid: Unable to determine a height for the datagrid. Cannot render. Exiting."),!1)}function na(){Ya.info("render"),ma()?(La=0,Ya.log("\trender %s",Va),Va===Ta.BUILDING?P(Ya.data):Va===Ta.READY?(Ya.dispatch(a.datagrid.events.ON_BEFORE_RENDER),Ga.add(ja),Ga.add(da),Ga.add(ka),Ga.add(Ya.dispatch,[a.datagrid.events.ON_AFTER_RENDER])):Ya.throwError(a.errors.E1001)):Ya.log("\tnot ready to render.")}function oa(){Ya&&Ya.warn("force update"),va(b.$eval(e.uxDatagrid),Ya.data)||pa()}function pa(){Ga.add(Ba,[],100)}function qa(a,b){if(a&&b&&a.length===b.length){for(var c=0,d=a.length;c<d;){if(ra(a[c],b[c]))return!0;c+=1}return Ya.data.length!==Ya.normalize(a,Ya.grouped).length&&(Ya.log("\tdirtyCheckData length is different"),!0)}return!0}function ra(a,b){return Ya.templateModel.getTemplate(a)!==Ya.templateModel.getTemplate(b)&&(Ya.log("\tdirtyCheckData row template changed"),!0)}function sa(b,c){Ya.log("\tmapData()");var d=[];a.each(Ya.getData(),ta,d),Ya.data=Ya.setData(b,Ya.grouped)||[],Ya.chunkModel.updateList(Ya.data),a.each(Ya.getData(),ua,d),d=null,Ca(a.datagrid.events.ON_AFTER_DATA_CHANGE,Ya.data,c)}function ta(a,b,c,d){d[b]=Ya.templateModel.getTemplate(a)}function ua(a,b,c,d){var e,f;Oa[b]&&(f=d[b],delete Oa[b][f.item],e=Ya.templateModel.getTemplate(a),Oa[b][e.item]=a,e!==d[b]&&Aa({},a,d[b].name,e.name,[],!0))}function va(c,d,f){if(Ya.info("\tonDataChanged |"+f+"| new:"+(c&&c.length||0)+" old:"+(d&&d.length||0)),Ya.grouped=b.$eval(e.grouped),d!==Ya.getOriginalData()&&(d=Ya.getOriginalData()),!Ya.options.smartUpdate||!Ya.data.length||qa(c,d)){var g=Ca(a.datagrid.events.ON_BEFORE_DATA_CHANGE,c,d);return g.defaultPrevented&&g.newValue&&(c=g.newValue),Wa.dirty=!0,Ga.add(xa,[c,d,f]),!0}return!!wa(c)&&(Wa.dirty=!0,sa(c,d),Ga.add(Ba,[],0),!0)}function wa(a){for(var b=0,c=Ya.normalize(a,Ya.grouped),d=a.length;b<d;){if(Ya.data[b]!==c[b])return!0;b+=1}return!1}function xa(b,c,d){if(Ya.flow.count(["changeData","onDataChanged"])>1)return void Ya.info("\tSKIPPED changeData |"+d+"| another is pending.");Ya.info("\tchangeData |"+d+"| :"+(b&&b.length||0)+" old:"+(c&&c.length||0)),Ya.templateModel.clearAllRowHeights(),Ca(a.datagrid.events.ON_BEFORE_RESET,Ya),Ya.data=Ya.setData(b,Ya.grouped)||[],ya(),Ga.add(Ca,[a.datagrid.events.ON_AFTER_DATA_CHANGE,Ya.data,c])}function ya(){Ya.info("reset start"),Ga.clear(),Ea(),Ra={},Pa.length=0,Oa.length=0,Ha.children().unbind(),Ha.children().remove(),Ya.chunkModel.getChunkList()?(Ya.chunkModel.reset(Ya.data,Ha,Oa),Ya.rowsLength=Ya.data.length,Ba()):P(Ya.data,!0),Ga.add(Ya.info,["reset complete"]),Ga.add(Ca,[a.datagrid.events.ON_AFTER_RESET,Ya])}function za(a){var c=Oa[a];!c&&a>=0&&a<Ya.rowsLength&&(c=N(a)),c&&!b.$$phase&&($(c,a),c.$digest(),Z(c,a),c.$digested=!0,Ya.templateModel.hasVariableRowHeights()&&(Ya.chunkModel.updateAllChunkHeights(a),ca()))}function Aa(a,c,d,e,f,g){var h,i=Ya.getNormalizedIndex(c),j=E(i),k=B(i);if(k&&k!==b){for(h=angular.element(Ya.templateModel.getTemplateByName(e).template),h.addClass(Ja.uncompiledClass);f&&f.length;)h.addClass(f.shift());j.parent()[0].replaceChild(h[0],j[0]),$(k,i),j.remove(),k.$destroy(),Oa[i]=null,g||(Ya.chunkModel.updateRow(i,c),Ba(i))}}function Ba(b){Ga.add(v),Ga.add(Ya.chunkModel.updateAllChunkHeights,[b]),Ga.add(ca),Ga.add(v),Ga.add(function(){var a=Ya.getContentHeight()-Ya.getViewportHeight();Wa.scroll>a&&(Wa.scroll=a)}),Ga.add(Ya.dispatch,[a.datagrid.events.ON_AFTER_HEIGHTS_UPDATED]),Ga.add(na),Ga.add(Ya.dispatch,[a.datagrid.events.ON_AFTER_HEIGHTS_UPDATED_RENDER])}function Ca(c){return Ya.options.debug&&Za.log("$emit %s",c),a.util.apply(b.$emit,b,arguments)}function Da(){clearInterval(Ka),Ya.shuttingDown||(Ka=setTimeout(function(){if(Ya){Ya.info("GC");var a,b=524288;for(a=0;a<b;a+=1).5}},5e3))}function Ea(){var a,d,e=0;c(Oa,function(b,c){if(b&&!b.$$destroyed){for(b.$$prevSibling=a||void 0,e=c;!d&&e<Ya.rowsLength;)e+=1,d=Oa[e]||void 0;$(b,c),a=b,b.$destroy()}}),b.$$childHead=void 0,b.$$childTail=void 0,Oa.length=0}function Fa(){for(Ya.shuttingDown=!0,n()[0].style.display="none",b.datagrid=null,Ya.log("destroying grid"),window.removeEventListener("resize",y),clearTimeout(Wa.scrollingStopIntv),Ga.destroy(),Ya.flow=void 0,Ga=null;Na.length;)Na.pop()();Ya.destroyLogger();for(var a in Ya)Ya[a]&&Ya[a].hasOwnProperty("destroy")&&(Ya[a].destroy(),Ya[a]=null);Ea(),d.remove(),delete b.$parent[Ya.name],Ra=null,Ya=null,b=null,d=null,e=null,Na=null,Ha=null,Pa.length=0,Pa=null,Oa.length=0,Oa=null,Wa=null,Ta=null,Ua=null,Ja=null,Xa=null,g=null}var Ga,Ha,Ia,Ja,Ka,La=0,Ma=!1,Na=[],Oa=[],Pa=[],Qa=0,Ra={},Sa=0,Ta=a.datagrid.states,Ua=a.datagrid.events,Va=Ta.BUILDING,Wa={dirty:!1,scroll:0,speed:0,absSpeed:0,scrollPercent:0,touchDown:!1,scrollingStopIntv:null,activeRange:{min:0,max:0},direction:0},Xa=[a.datagrid.events.LOG,a.datagrid.events.INFO,a.datagrid.events.WARN,a.datagrid.events.ERROR],Ya=this,Za={},$a=!1,_a={};return a.logWrapper("datagrid event",Ya,"grey",Ya),a.logWrapper("datagrid",Ya,"green",Ya),a.logWrapper("events",Za,"light",Ya),b.datagrid=Ya,j(),Ya}function h(a,b){var c=0;"string"==typeof a&&(a=a.split("."));for(var d=0;d<a.length;d+=1)a[d]=parseInt(a[d],10),d<a.length-1?c+=a[d]*b:c+=a[d];return c}function i(a){this.uid=i.uid++,this.enabled=!0,this.min=0,this.max=0,this.templateStart="",this.templateStartWithPos="",this.templateEnd="",this.parent=null,this.mode=a?i.DETACHED:i.ATTACHED,this.detachDom=a,this.index=0}"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&module.exports?module.exports=a:b.ux=a,function(a,b){b.util=a;var c,d,e=function(){};(function(){var a,b,f,g,h,i="~",j=".";a=Function[i]=Function[i]||function(b){return a[b]||(a[b]={}),a[b]},g=a("c"),b=a("d"),f=a("p"),h=function(a){if(!b[a]){var c=arguments,d=c[1];"function"==typeof d?b[a]=d():(g[a]=c[2],g[a][j]=d)}},c=d=function(){h.apply(null,arguments)},resolve=function(a,c){f[a]=!0;var d,e,h,i=c[j],k=[];if(i)for(e=i.length,d=0;d<e;d++)h=i[d],g[h]&&(f.hasOwnProperty(h)||resolve(h,g[h]),resolve(h,g[h]),delete g[h]);if(!b.hasOwnProperty(a)){for(d=0;d<e;d++)h=i[d],k.push(b.hasOwnProperty(h)&&b[h]);b[a]=c.apply(null,k)}delete f[a]},e=function(){for(var a in g)resolve(a,g[a])}})(),c("isArguments",function(){var a=function(){var a=[];for(var b in this)this.hasOwnProperty(b)&&a.push(""+b);return"["+a.join(", ")+"]"};return function(b){var c=String(b),d="[object Arguments]"===c;return d||(d="[object Array]"!==c&&null!==b&&"object"==typeof b&&"number"==typeof b.length&&b.length>=0&&(!b.callee||"[object Function]"===a.call(b.callee))),d}}),c("dg.api",["isMatch","apply","toArray","sort","dispatcher","matchAll"],function(b,c,d,e,f,g){a.isMatch=b,a.apply=c,a.dispatcher=f,a.matchAll=g,a.array={toArray:d,sort:e}}),c("isRegExp",function(){return function(a){return"[object RegExp]"===Object.prototype.toString.call(a)}}),c("isDate",function(){return function(a){return a instanceof Date}}),c("apply",["isFunction"],function(a){return function(b,c,d){if(a(b)){switch(d=d||[],d.length){case 0:return b.call(c);case 1:return b.call(c,d[0]);case 2:return b.call(c,d[0],d[1]);case 3:return b.call(c,d[0],d[1],d[2]);case 4:return b.call(c,d[0],d[1],d[2],d[3]);case 5:return b.call(c,d[0],d[1],d[2],d[3],d[4]);case 6:return b.call(c,d[0],d[1],d[2],d[3],d[4],d[5])}return b.apply(c,d)}}}),c("isFunction",function(){return function(a){return"function"==typeof a}}),c("toArray",["isArguments","isArray","isUndefined"],function(a,b,c){return function(d){if(a(d))return Array.prototype.slice.call(d,0)||[];try{if(b(d))return d;if(!c(d))return[].concat(d)}catch(a){}return[]}}),c("isMatch",["isRegExp","isDate"],function(a,b){function c(e,f){var g;if(e===f)return!0;if("object"==typeof f){if(g=typeof e,-1!==d.indexOf(g)){if(a(f)&&!f.test(e+""))return!1;if(b(f))return!(!b(e)||f.getTime()!==e.getTime())}if(e instanceof Array&&void 0!==f[0]){for(var h=0;h<e.length;h+=1)if(c(e[h],f[0]))return!0;return!1}for(var i in f)if(f.hasOwnProperty(i)){if(void 0===e[i]&&!e.hasOwnProperty(i))return!1;if(!c(e[i],f[i]))return!1}return!0}return"function"==typeof f&&!!f(e)}var d=["string","number","boolean"];return c}),c("isArray",function(){return Array.prototype.__isArray=!0,Object.defineProperty(Array.prototype,"__isArray",{enumerable:!1,writable:!0}),function(a){return!!a&&!!a.__isArray}}),c("isUndefined",function(){return function(a){return void 0===a}}),c("sort",function(){function a(a,c,d,e){var f,g=a[d-1],h=c;for(f=c;f<d-1;f+=1)e(a[f],g)<0&&(f!==h&&b(a,f,h),h+=1);return e(a[h],g)&&b(a,h,d-1),h}function b(a,b,c){var d=a[b];return a[b]=a[c],a[c]=d,a}function c(b,d,e,f){if(d<e){var g=a(b,d,e,f);c(b,d,g,f),c(b,g+1,e,f)}return b}return function(a,b){return c(a,0,a.length,b)}}),c("dispatcher",["apply","isFunction","dispatcherEvent"],function(a,b,c){function d(a){if(!a)throw Error("event cannot be undefined")}return function(e,f,g){function h(a,b){var c=r[a];if(c)for(var d=0;d<c.length;d+=1)if(c[d].cb===b)return d;return-1}function i(a,b){d(a);var c=h(a,b),e=r[a];-1!==c&&e.splice(c,1)}function j(a,c,e){if(b(c))return d(a),r[a]=r[a]||[],r[a].push({cb:c,priority:void 0!==e?e:10}),r[a].sort(l),function(){i(a,c)}}function k(c,g,h){function k(){i(c,k),a(g,f||e,arguments)}if(b(g))return d(c),j(c,k,h)}function l(a,b){return a.priority-b.priority}function m(a,b,c){c[b]=a.cb}function n(a,b){d(a);var c,e="*";return a||b?(c=[],r[e]&&(c=r[e].concat(c)),r[a]&&(c=r[a].concat(c)),c.map(m),c):r}function o(){r={}}function p(b,c){return b&&a(b,e,c)}function q(a){d(a);var b,e=n(a,!0),f=e.length,a="object"==typeof a?a:new c(a);if(f)for(arguments[0]=a,b=0;b<f;b+=1)a.immediatePropagationStopped||p(e[b],arguments);return a}if(e&&e.on&&e.on.dispatcher)return e;e=e||{};var r={};return j.dispatcher=!0,f&&g?(e.on=f[g.on]&&f[g.on].bind(f),e.off=f[g.off]&&f[g.off].bind(f),e.once=f[g.once]&&f[g.once].bind(f),e.dispatch=e.fire=f[g.dispatch].bind(f)):(e.on=j,e.off=i,e.once=k,e.dispatch=e.fire=q),e.getListeners=n,e.removeAllListeners=o,e}}),c("dispatcherEvent",function(){function a(a){this.type=a,this.defaultPrevented=!1,this.propagationStopped=!1,this.immediatePropagationStopped=!1}return a.prototype.preventDefault=function(){this.defaultPrevented=!0},a.prototype.stopPropagation=function(){this.propagationStopped=!0},a.prototype.stopImmediatePropagation=function(){this.immediatePropagationStopped=!0},a.prototype.toString=function(){return this.type},a}),c("matchAll",["isMatch"],function(a){function b(b,c){for(var d=[],e=0;e<b.length;e+=1)a(b[e],c)&&d.push(b[e]);return d}return b}),e(),b.util}(this.util||{},function(){return a}()),a.errors={E1000:"Datagrid cannot have a height of 0",E1001:"RENDER STATE INVALID. The only valid render states are those on ux.datagrid.states",E1002:"Unable to render. Invalid activeRange.",E1101:"Script templates that are used for datagrid rows must have a height greater than 0. This may be because the grid is not yet attached to the dom preventing it from calculating heights.",E1102:"at least one template is required. There were no row templates found for the datagrid."};var j,k=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),l=function(){var a=angular.$$csp();return angular.isObject(a)?a.noInlineStyle:a}();try{j=angular.module("ux",["ng"])}catch(a){j=angular.module("ux")}a.datagrid={version:"1.6.12",isIOS:k,isNoInlineStyle:l,states:{BUILDING:"datagrid:building",READY:"datagrid:ready"},events:{ON_INIT:"datagrid:onInit",ON_LISTENERS_READY:"datagrid:onListenersReady",ON_READY:"datagrid:onReady",ON_STARTUP_COMPLETE:"datagrid:onStartupComplete",ON_BEFORE_RENDER:"datagrid:onBeforeRender",ON_AFTER_RENDER:"datagrid:onAfterRender",ON_BEFORE_UPDATE_WATCHERS:"datagrid:onBeforeUpdateWatchers",ON_AFTER_UPDATE_WATCHERS:"datagrid:onAfterUpdateWatchers",ON_BEFORE_DATA_CHANGE:"datagrid:onBeforeDataChange",ON_AFTER_DATA_CHANGE:"datagrid:onAfterDataChange",ON_BEFORE_RENDER_AFTER_DATA_CHANGE:"datagrid:onBeforeRenderAfterDataChange",ON_RENDER_AFTER_DATA_CHANGE:"datagrid:onRenderAfterDataChange",ON_ROW_TEMPLATE_CHANGE:"datagrid:onRowTemplateChange",ON_SCROLL:"datagrid:onScroll",ON_BEFORE_RESET:"datagrid:onBeforeReset",ON_AFTER_RESET:"datagrid:onAfterReset",ON_AFTER_HEIGHTS_UPDATED:"datagrid:onAfterHeightsUpdated",ON_AFTER_HEIGHTS_UPDATED_RENDER:"datagrid:onAfterHeightsUpdatedRender",ON_BEFORE_ROW_DEACTIVATE:"datagrid:onBeforeRowDeactivate",ON_AFTER_ROW_ACTIVATE:"datagrid:onAFterRowActivate",ON_ROW_COMPILE:"datagrid:onRowCompile",ON_SCROLL_TO_TOP:"datagrid:onScrollToTop",ON_SCROLL_TO_BOTTOM:"datagrid:onScrollToBottom",RESIZE:"datagrid:resize",UPDATE:"datagrid:update",SCROLL_TO_INDEX:"datagrid:scrollToIndex",SCROLL_TO_ITEM:"datagrid:scrollToItem",SCROLL_INTO_VIEW:"datagrid:scrollIntoView",LOG:"datagrid:log",INFO:"datagrid:info",WARN:"datagrid:warn",ERROR:"datagrid:error"},getGrid:function(b){for(var c;b;){if(b.datagrid)return b.datagrid;if(b.$$childHead&&(c=a.datagrid.getGrid(b.$$childHead)))return c;b=b.$$nextSibling}return null},throwError:function(a){window.console&&console.warn&&console.warn(a)},options:{async:!0,updateDelay:100,creepRender:{enable:!0},creepStartDelay:50,cushion:-100,chunks:{detachDom:null,size:50,chunkClass:"datagrid-chunk",chunkDisabledClass:"datagrid-chunk-disabled",chunkReadyClass:"datagrid-chunk-ready"},scrollModel:{speed:5,manual:!0,simulateClick:!1,preventTouchMove:!1},compiledClass:"compiled",uncompiledClass:"uncompiled",contentClass:"datagrid-content",rowClass:"datagrid-row",renderThreshold:1,renderThresholdWait:20,creepLimit:500,smartUpdate:!0,readyToRenderRetryMax:10,minHeight:100,iosWebkitScrolling:!0,scrollEndRenderAmount:2,forceRenderAfterScrollEventsCount:4},coreAddons:[]},j.factory("gridAddons",["$injector",function(a){function b(b,c){for(var d,e=0,f=b.length;e<f;){if(!("function"==typeof(d=a.get(b[e]))||d instanceof Array))throw new Error("Addons expect a function ($injector array supported) to pass the grid instance to.");a.invoke(d,c,{inst:c}),e+=1}}return function(a,c){c=c instanceof Array?c:c&&c.replace(/,/g," ").replace(/\s+/g," ").split(" ")||[],a.addons&&(c=a.addons=a.addons.concat(c)),b(c,a)}}]),a.css=function(){function a(a){return b(a)||(j[a]=c(a)),b(a)}function b(a){return j[a]}function c(a){if(document.styleSheets&&0!==document.getElementsByTagName(l.head).length){var b,c,d,e;if(document.styleSheets.length>0)for(d=0;d<document.styleSheets.length&&(document.styleSheets[d].disabled||(e=document.styleSheets[d].media,c=typeof e,c===l.string?""!==e&&-1===e.indexOf(l.screen)||(b=document.styleSheets[d]):c===l.object&&(""!==e.mediaText&&-1===e.mediaText.indexOf(l.screen)||(b=document.styleSheets[d])),void 0===b));d++);var f=document.createElement("style");f.type="text/css",f.title=a,document.getElementsByTagName(l.head)[0].appendChild(f);var g=document.styleSheets.length-1;return b=document.styleSheets[g],{name:a,styleSheet:b}}}function d(a){for(var b=j[a],c=document.styleSheets.length,d=0;d<c;d+=1)document.styleSheets[d]===b.styleSheet&&document.styleSheets.splice(d,1);delete j[a],b=null}function e(c,d,e){var f,g=b(c)||a(c),h=g.styleSheet;if(h.addRule){for(f=0;f<h.rules.length;f++)if(h.rules[f].selectorText&&h.rules[f].selectorText.toLowerCase()===d.toLowerCase())return void(h.rules[f].style.cssText=e);if(h.addRule(d,e),h.rules[h.rules.length-1].cssText===d+" { }")throw new Error("CSS failed to write")}else if(h.insertRule){for(f=0;f<h.cssRules.length;f++)if(h.cssRules[f].selectorText&&h.cssRules[f].selectorText.toLowerCase()===d.toLowerCase())return void(h.cssRules[f].style.cssText=e);h.insertRule(d+"{"+e+"}",0)}}function f(a){var b,c,d,e,f;if(-1!==a.indexOf("{")||-1!==a.indexOf("}"))return null;if(k[a])return k[a];for(b=0,c=document.styleSheets.length;b<c;b+=1)if(d=document.styleSheets[b],e=d.rules||d.cssRules,f=g(e,a))return f;return null}function g(a,b){var c,d,e,f;if(a)for(c=0,d=a.length;c<d;c+=1){if(e=a[c],e.cssRules&&(f=g(e.cssRules,b)))return f;if(e.selectorText){var h="(\b)*"+b.replace(".","\\.")+"([^-a-zA-Z0-9]|,|$)",i=e.selectorText.match(h);if(i&&-1!==i.indexOf(b))return k[b]=e.style,e.style}}return null}function h(a,b){var c=f(a);return c&&void 0!==c[b]?c[b]:null}function i(a,b,c){f(a)[b]=c}var j={},k={},l={head:"head",screen:"screen",string:"string",object:"object"};return{createdStyleSheets:[],createStyleSheet:c,createClass:e,getCSSValue:h,setCSSValue:i,getSelector:f,removeStyleSheet:d}}(),a.each=c,a.filter=d,a.extend=e,function(){"use strict";var b=0;a.uid=function(){b+=1;for(var a=b.toString(36).toUpperCase();a.length<6;)a="0"+a;return a}}(),a.logWrapper=function(b,c,d,e){function f(a,b){"function"==typeof a&&g(a,c,b)}var g=a.util.apply;return d=d||"black",c.$logName=b,c.log=c.info=c.warn=c.error=function(){},c.log=function(){var c=[a.datagrid.events.LOG,b,d].concat(a.util.array.toArray(arguments));e.logger?g(e.logger.log,e.logger,c):f(e,c)},c.info=function(){var c=[a.datagrid.events.INFO,b,d].concat(a.util.array.toArray(arguments));e.logger?g(e.logger.info,e.logger,c):f(e,c)},c.warn=function(){var c=[a.datagrid.events.WARN,b,d].concat(a.util.array.toArray(arguments));e.logger?g(e.logger.warn,e.logger,c):f(e,c)},c.error=function(){var c=[a.datagrid.events.ERROR,b,d].concat(a.util.array.toArray(arguments));e.logger?g(e.logger.error,e.logger,c):f(e,c)},c.destroyLogger=function(){e.logger&&(e.log("destroy"),e.logger.destroy(),e.logger=null)},c},a.datagrid.Flow=f,j.directive("uxDatagrid",["$compile","gridAddons","$timeout",function(b,d,e){return{restrict:"AE",scope:!0,link:{pre:function(f,h,i){var j=new g(f,h,i,b,e);c(a.datagrid.coreAddons,function(b){a.util.apply(b,j,[j])}),d(j,a.datagrid.defaultAddons||""),d(j,i.addons)},post:function(a,b,c){a.datagrid.start()}}}}]),a.datagrid.coreAddons.chunkModel=function(b){function c(){return C}function d(a,c,e,f){for(var g,h,j=0,k=a.length,l=new i(b.options.chunks.detachDom);j<k;)h=a[j],j%c==0&&(g&&g.updateHeight(b.templateModel,D),g=new i(b.options.chunks.detachDom),g.min=h.min||j,g.templateModel=b.templateModel,g.templateStart=e,g.templateEnd=f,g.parent=l,g.index=l.length,l.push(g)),h instanceof i&&(h.parent=g,h.index=g.length),g.push(h),g.max=h.max||j,j+=1;return g&&g.updateHeight(b.templateModel,D),l.min||(l.min=l[0]?l[0].min:0,l.max=l[l.length-1]?l[l.length-1].max:0,l.templateStart=e,l.templateEnd=f,l.updateHeight(b.templateModel,D),l.dirtyHeight=!1),l.length>c?d(l,c,e,f):l}function e(a){var c,d;void 0===a||b.options.chunks.detachDom?C&&(C.forceHeightReCalc(b.templateModel,D),C.updateHeight(b.templateModel,D,1,!0),C.detachDom&&C.updateDomHeight(1)):(c=m(a,C),d=f(c,C),d.updateHeight(b.templateModel,D,-1,!0))}function f(a,b){for(var c;a.length;)c=a.shift(),b[c]instanceof i&&(b=b[c]);return b}function g(a,b,c,e,f){return I.log("chunkDom"),F=f,E=b,D=a,G=c,H=e,C=d(a,b,c,e),y(C),C.updateDomHeight(1),f}function j(a){if(D.length!==a.length)return g(a,E,G,H,F);for(var b=0,c=a.length;b<c;)k(b,a[b]),b+=1}function k(a,b){var c=m(a,C),d=c.pop(),e=p(c);e&&e[d]&&(e[d]=b,e.dirtyHeight=!0),D[a]=b}function m(a,b,c){if(!b)return[];var d,e=0,f=b.length;for(c=c||[];e<f;){if(!((d=b[e])instanceof i)){c.push(a%E);break}if(a>=d.min&&a<=d.max){c.push(e),m(a,d,c);break}e+=1}return c}function n(a){var b=m(a,C),c=u(b);return c&&c.length&&void 0===c.attr("row-id")&&c.attr("row-id",a),c}function o(a){if(C){return q(m(a,C))}}function p(a){for(var b=a.slice(0),c=C;b.length;)c=c[b.shift()];return c}function q(a,b){for(var c,d=0,e=a.slice(0),f=C,g=F;d<e.length;)c=e.shift(),!b||f.rendered&&!r(f)||(b(g,f),y(f)),e.length||w(f),f=f[c],g=f.rendered||angular.element(g.children()[c]);return g}function r(a){var b=!a.hasChildChunks()&&a.length&&a.rendered&&a.rendered.children().length!==a.length;return b&&I.info("recompile chunk %s",a.getId()),b}function s(a){function b(a,b){return b.toUpperCase()}for(var c=a.length,d=0;d<c;d++){var e=a[d],f=e.getAttribute("data-style");if(f)for(var g=f.split(";"),h=g.length,i=0;i<h;i++){var j=g[i];if(j&&-1!==j.indexOf(":")){var k=j.split(":"),l=k[0],m=k[1],n=l.replace(/-(.)/g,b);e.style[n]=m}}}}function t(c,d){var e,f,g=0;if(c.html(d.getChildrenStr(!1,E)),e=c.children(),d.rendered=c,d.hasChildChunks())for(l&&s(e),f=e.length;g<f;)d[g].dom=e[g],g+=1;d.detachDom&&d.dirtyHeight&&d.updateDomHeight(),a.each(e,v),d.hasChildChunks()?-1!==e[0].className.indexOf(b.options.chunks.chunkClass)&&e.addClass(b.options.chunks.chunkReadyClass):d.rendered.hasClass(b.options.chunks.chunkReadyClass)||d.rendered.addClass(b.options.chunks.chunkReadyClass)}function u(a){return q(a,t)}function v(a){if(a){var b=window.getComputedStyle(a);if(b)return b.getPropertyValue("top")}}function w(a){return a.compiled||(a.compiled=x(a),a.compiled&&(a.parent&&w(a.parent),b.flow.add(A))),a.compiled}function x(a){var c,d;if(a[0]instanceof i){for(c=0,d=a.length;c<d;){if(!a[c].compiled)return!1;c+=1}return!0}for(c=a.min,d=a.max;c<d;){if(!b.isCompiled(c))return!1;c+=1}return!0}function y(a){a.updateDom(b.options.chunks.chunkDisabledClass)}function z(a,b,c){I.log("reset"),J.length=0,a=a||[],C&&(C.destroy(),C=null,F=null,D=null),g(a,E,G,H,b)}function A(){var a=b.values.activeRange,c=b.options.chunks;C.enableRange(a.min,a.max,c.chunkDisabledClass),c.detachDom&&y(C)}function B(){z(),C=null,D=null,E=null,F=null,G=null,H=null,J.length=0,J=null,b.chunkModel=null,I.destroyLogger(),I=null,b=null}var C,D,E,F,G,H,I=a.logWrapper("chunkModel",{},"purple",b),J=[];return b.flow.unique(y),I.chunkDom=g,I.getChunkList=c,I.getRowIndexes=function(a){return m(a,C)},I.getItemByIndexes=p,I.getRow=n,I.getExistingRow=o,I.reset=z,I.updateRow=k,I.updateList=j,I.updateAllChunkHeights=e,I.getRowIndexFromIndexes=h,I.destroy=B,b.scope.$on(a.datagrid.events.ON_AFTER_UPDATE_WATCHERS,A),a.util.dispatcher(I),b.chunkModel=I,I},a.datagrid.coreAddons.push(a.datagrid.coreAddons.chunkModel),i.uid=0,i.DETACHED="chunkArray:detached",i.ATTACHED="chunkArray:attached",i.prototype=[],i.prototype.getStub=function(a){return this.templateStartWithPos||this.createDomTemplates(),this.templateStartWithPos+a+this.templateEnd},i.prototype.inRange=function(a){return a>=this.min&&a<=this.max},i.prototype.rangeOverlap=function(a,b,c){var d=!1;for(c=c>0?c:0,a-=c,b+=c;a<=b;){if(this.inRange(a)){d=!0;break}a+=1}return d},i.prototype.each=function(b,c){for(var d=0,e=this.length;d<e;)a.util.apply(b,this[d],c),d+=1},i.prototype.getChildrenStr=function(a,b){for(var c=0,d=this.length,e="",f=this;c<d;)f[c]instanceof i?e+=f[c].getStub(a?f[c].getChildrenStr(a):"",b):(h(f._id+"."+c,b),e+=this.templateModel.getTemplate(f[c]).template),c+=1;return e},i.prototype.updateHeight=function(a,b,c,d){var e,f=0,g=0;if(this[0]instanceof i)for(e=this.length;f<e;)1===c&&this[f].updateHeight(a,b,c,d),g+=this[f].height,f+=1;else g=a.getHeight(b,this.min,this.max);this.height!==g?(this.dirtyHeight=!0,this.height=g):this.rendered,-1==c&&this.dirtyHeight&&this.parent&&this.parent.updateHeight(a,b,c,d),d&&this.dirtyHeight&&this.updateDomHeight()},i.prototype.getPreviousSibling=function(){var a,b;return this.parent&&(b=this.index-1,(a=this.parent[b])&&a.index===this.index-1||this.parent.parent&&(a=this.parent.getPreviousSibling())&&(a=a.last())),a},i.prototype.getNextSibling=function(){var a,b;return this.parent&&(b=this.index+1,(a=this.parent[b])&&a.index===this.index+1||this.parent.parent&&(a=this.parent.getNextSibling())&&(a=a.first())),a},i.prototype.first=function(){return this[0]},i.prototype.last=function(){return this[this.length-1]},i.prototype.calculateTop=function(){var a,b=0;return this.index&&this.parent&&(a=this.getPreviousSibling())&&(b=a.top+a.height),this.top=b,this.top},i.prototype.forceHeightReCalc=function(a,b){var c,d=0,e=0;if(this[0]instanceof i)for(c=this.length;d<c;)e+=this[d].forceHeightReCalc(a,b),d+=1;else e=a.getHeight(b,this.min,this.max);return this.height!==e&&(this.height=e,this.detachDom?this.dirtySiblings():this.setDirtyHeight()),this.height},i.prototype.setDirtyHeight=function(){for(var a=this;a;)a.dirtyHeight=!0,a=a.parent},i.prototype.dirtySiblings=function(){if(this.dirtyHeight=!0,this.parent){for(var a=0,b=this.length;a<b;)this[a].dirtyHeight=!0,a+=1;this.parent.dirtySiblings()}},i.prototype.getId=function(){if(this._index!==this.index||!this._id){var a=this,b="";for(this._index=this.index;a;)b="."+a.index+b,a=a.parent;this._id=b.substr(1,b.length)}return this._id},i.prototype.hasChildChunks=function(){return this._hasChildChunks||(this._hasChildChunks=this.first()instanceof i),this._hasChildChunks},i.prototype.enableRange=function(a,b,c){this.rangeOverlap(a,b,this.detachDom)?this.enable(c):this.disable(c),this.hasChildChunks()&&this.each(this.enableRange,[a,b,c])},i.prototype.enable=function(a){this.enabled||(this.enabled=!0,this.updateDom(a),this.parent&&this.parent.enable(a))},i.prototype.disable=function(a){var b,c=0;if(this.compiled){if(this.hasChildChunks())for(b=this.length;c<b;)this[c].disable(a),c+=1;this.enabled&&(this.enabled=!1,this.updateDom(a))}},i.prototype.updateDom=function(a){this.rendered&&(this.compiled&&!this.rendered.attr("compiled")&&this.rendered.attr("compiled",!0),this.detachDom?this.enabled?this.detached&&(this.detached=!1,this.parent.rendered.append(this.rendered)):this.enabled||this.detached||this.parent&&this.parent.compiled&&this.rendered.parent().length&&(this.detached=!0,this.rendered.remove(void 0,!0)):(this.rendered.attr("enabled",this.enabled),this.enabled?(this.rendered.removeAttr("disabled"),this.rendered.removeAttr("read-only"),this.rendered.removeClass(a)):(this.rendered.attr("disabled","disabled"),this.rendered.attr("read-only",!0),this.rendered.addClass(a))),this.each(this.updateDom,[a]))},i.prototype.updateDomHeight=function(a){var b=this.rendered&&this.rendered[0]||this.dom;b?(this.dirtyHeight=!1,this.mode===i.DETACHED&&(this.calculateTop(),b.style.top=this.top+"px"),b.style.height=this.height+"px"):this.createDomTemplates(),-1===a&&this.parent?this.parent.updateDomHeight(a):a&&this.hasChildChunks()&&this.each(this.updateDomHeight,[a])},i.prototype.createDomTemplates=function(){if(!this.templateReady&&this.templateStart){var a=this.templateStart.substr(0,this.templateStart.length-1)+(l?' data-style="':' style="');this.mode===i.DETACHED&&(this.calculateTop(),a+="position:absolute;top:"+this.top+"px;left:0px;"),this.templateStartWithPos=a+"width:100%;height:"+this.height+'px;" chunk-id="'+this.getId()+'" range="'+this.min+":"+this.max+'">',this.templateReady=!0}},i.prototype.children=function(){var a=[];this.each(function(){a.push(this.rendered)},[])},i.prototype.decompile=function(a){this.hasChildChunks()?this.each("decompile",[a]):this.rendered&&(this.rendered.children().remove(),this.rendered.removeClass(a))},i.prototype.destroy=function(){for(this.hasChildChunks()&&this.each(this.destroy),this.templateStart="",this.templateEnd="",this.templateModel=null,this.rendered=null,this.dom=null,this.parent=null;this.length;)this.pop();this.length=0},a.datagrid.events.ON_RENDER_PROGRESS="datagrid:onRenderProgress",a.datagrid.events.STOP_CREEP="datagrid:stopCreep",a.datagrid.events.ENABLE_CREEP="datagrid:enableCreep",a.datagrid.events.DISABLE_CREEP="datagrid:disableCreep",a.datagrid.coreAddons.creepRenderModel=function(b){function d(a){if(b.scope.$root.$$phase)return!1;var c=b.getScope(a);return c&&c.$digested||b.forceRenderScope(a),!0}function e(){var a={count:0};return c(b.scopes,f,a),a.count>=b.rowsLength&&D.disable(),{count:a.count,len:b.rowsLength}}function f(a,b,c,d){d.count+=a?1:0}function g(a,c,d){D.log("\tonInterval"),b.values.touchDown||(C||D.info("start creeping",E+".."+F+" - "+w+".."+x),y=!1,z=Date.now()+b.options.renderThreshold,E=a,F=c,j(n,d))}function h(c,d){D.log("wait",d);var e=a.util.array.toArray(arguments);if(e.splice(0,2),b.options.async)return D.log("\tstart waiting",d),setTimeout(function(){D.log("\twait HANDLE execute"),a.util.apply(c,null,e)},d);D.log("\twait execute"),a.util.apply(c,this,e)}function i(a,c){for(;a>=0&&a<b.rowsLength&&b.isCompiled(a);)a+=c;return a>=0&&a<b.rowsLength?a:c>0?b.rowsLength:-1}function j(a,c,d){var e,f,g=Date.now();d=d||0,z>g&&o()&&d<K?(e=b.templateModel.hasVariableRowHeights(),f=b.values.direction,D.info("direction",f),k(f,c),j(a,c,d+=1),e&&s()):a()}function k(a,b,c){c=c||2;var d;if(a){d=-1===a?l:m;for(var e=0;e<c&&d(b);e+=1);}else l(b),m(b)}function l(a){if((E=a?E:i(E,-1))>=w&&d(E))return a&&D.info("\trenderUp "+E),E-=1,!0}function m(a){if((F=a?F:i(F,1))<=x&&d(F))return a&&D.info("\trenderDown "+F),F+=1,!0}function n(){if(D.info("onComplete "+C+"/"+b.options.creepLimit),o()){C+=1,b.values.touchDown||b.values.speed||!o()||q(E,F);var c=e();c!==A&&b.dispatch(a.datagrid.events.ON_RENDER_PROGRESS,c)}else C=0,D.disable(),A=1,b.dispatch(a.datagrid.events.ON_RENDER_PROGRESS,1)}function o(){return!!(E>-1||F<b.rowsLength)}function p(){D.warn("stop"),z=0,clearTimeout(B)}function q(a,c,d,e){D.info("resetInterval"),C<b.options.creepLimit?(D.info("creep "+C+"/"+b.options.creepLimit),clearTimeout(B),z=0,B=h(g,d||b.options.renderThresholdWait,a,c,e)):D.warn("finish creeping: "+C+"/"+b.options.creepLimit,E+".."+F+" is creeped out")}function r(a,c){q(E,F,b.options.creepStartDelay,c)}function s(){H=!0;var a=b.getRowOffset(I)+J;b.scrollModel.scrollTo(a,!0),H=!1}function t(a){D.info("onBeforeRender"),H||b.templateModel.hasVariableRowHeights()&&(I=b.getOffsetIndex(b.values.scroll),J=b.values.scroll-b.getRowOffset(I))}function u(a,c,d){D.info("onAfterRender"),C=0,E=c.started||0,F=c.ended||0,w=Math.max(E-b.options.creepLimit,0),x=Math.min(F+b.options.creepLimit,b.rowsLength),r(a,d)}function v(a){D.info("onBeforeReset"),t(a),b.options.creepRender&&!1!==b.options.creepRender.enable&&D.enable()}var w,x,y,z,A,B=0,C=0,D=a.logWrapper("creepModel",{},"blue",b),E=0,F=0,G=[],H=!1,I=0,J=0,K=50;D.stop=p,D.forceRenderNext=function(){D.info("forceRenderNext"),k(b.values.direction,!0,b.options.scrollEndRenderAmount)},D.destroy=function(){D.disable(),b=null,D=null},D.enable=function(){G.length||G.push(b.scope.$on(a.datagrid.events.ON_AFTER_UPDATE_WATCHERS,u))},D.disable=function(){for(p(),D.info("creep Disabled");G.length;)G.pop()()},b.unwatchers.push(b.scope.$on(a.datagrid.events.DISABLE_CREEP,D.disable)),b.unwatchers.push(b.scope.$on(a.datagrid.events.ON_BEFORE_RESET,v)),b.unwatchers.push(b.scope.$on(a.datagrid.events.STOP_CREEP,p)),b.creepRenderModel=D,b.options.creepRender&&b.options.creepRender.enable?D.enable():D.disable()},a.datagrid.coreAddons.push(a.datagrid.coreAddons.creepRenderModel),a.datagrid.coreAddons.normalizeModel=function(b){function c(a,d,e,f,g){var h;return g=g.slice(0),g.push(d),a===f?g:a[b.grouped]&&a[b.grouped].length&&(h=ux.each(a[b.grouped],c,f,g))&&h!==a[b.grouped]?h:void 0}function d(a,b,c,d){"replace"===d?a[b]=c:"insert"===d?a.splice(b,0,c):"remove"===d&&a.splice(b,1)}function e(a,c,e){for(var h,i,j=b.getOriginalIndexOfItem(g[c]),k=f;j.length;){if(i=j.shift(),h=k[i],!j.length){b.grouped&&k[0]&&k[0].hasOwnProperty(b.grouped)&&(k=k[0][b.grouped],j.push(k.length),i=k.length),d(k,i,a,e);break}b.grouped&&(k=h[b.grouped])}d(g,c,a,e)}var f,g,h=a.logWrapper("normalizeModel",{},"grey",b);return b.normalize=function(a,c,d){a=a||[];var e=0,f=a.length;for(d=d||[];e<f;)d.push(a[e]),a[e]&&a[e][c]&&b.normalize(a[e][c],c,d),e+=1;return d},b.setData=function(a,c){return h.log("setData %s",a),f=a,g=c?b.normalize(a,c):a&&a.slice(0)||[]},b.getData=function(){return g},b.getOriginalData=function(){return f},b.getOriginalIndexOfItem=function(a){var b=ux.each(f,c,a,[]);return b&&b!==f?b:[]},b.getNormalizedIndex=function(a,c){for(var d=c||0;d<b.rowsLength;){if(b.data[d]===a)return d;d+=1}if(c)for(d=c;d>=0;){if(b.data[d]===a)return d;d-=1}return-1},h.replace=function(a,b){e(a,b,"replace")},h.insert=function(a,b){e(a,b,"insert")},h.remove=function(a){e(null,a,"remove")},h.move=function(a,c){var d=b.getRowItem(a);a>c?(h.remove(a),h.insert(d,c)):a<c&&(h.insert(d,c),h.remove(a))},h.destroy=function(){h.destroyLogger(),f=null,g=null,b.normalizeModel=null,b=null,h=null},b.normalizeModel=h,b},a.datagrid.coreAddons.push(a.datagrid.coreAddons.normalizeModel),a.datagrid.events.ON_SCROLL_START="datagrid:scrollStart",a.datagrid.events.ON_SCROLL_STOP="datagrid:scrollStop",a.datagrid.events.ON_TOUCH_DOWN="datagrid:touchDown",a.datagrid.events.ON_TOUCH_UP="datagrid:touchUp",a.datagrid.events.ON_TOUCH_MOVE="datagrid:touchMove",a.datagrid.coreAddons.scrollModel=function(b){function c(){p(),b.element.css("overflow")&&"visible"!==b.element.css("overflow")?a.datagrid.isIOS&&b.options.iosWebkitScrolling&&b.element.css({overflowY:"scroll",webkitOverflowScrolling:"touch"}):b.element.css({overflow:"auto"}),d(),b.unwatchers.push(b.scope.$on(a.datagrid.events.SCROLL_TO_INDEX,function(a,c){b.scrollModel.scrollToIndex(c,!0)})),b.unwatchers.push(b.scope.$on(a.datagrid.events.SCROLL_TO_ITEM,function(a,c){b.scrollModel.scrollToItem(c,!0)})),b.unwatchers.push(b.scope.$on(a.datagrid.events.SCROLL_INTO_VIEW,function(a,c){b.scrollModel.scrollIntoView(c,!0)})),g(),z=!0}function d(){y.log("addScrollListener"),C=!0,b.element[0].addEventListener("scroll",k,{passive:!0})}function e(){b.options.scrollModel&&b.options.scrollModel.manual&&(G[1].enabled=!0),C&&(y.removeScrollListener(),C=!1),y.removeTouchEvents()}function f(){C||d(),g()}function g(){y.log("addTouchEvents");var c=b.getContent();a.each(G,function(a){a.enabled&&(y.log("\tadd %s",a.event),c[0].addEventListener(a.event,y[a.method],{passive:!0}))})}function h(a){return a.touches||a.originalEvent.touches}function i(){return b.values.scroll}function j(a){q||(b.element[0].scrollTop=a),b.values.scroll=a}function k(a){clearTimeout(x),a.target&&!b.values.touchDown&&(b.values.scrollEventsSinceLastRender=b.values.scrollEventsSinceLastRender||0,a&&void 0!==(a.target||a.srcElement).scrollTop&&y.onUpdateScroll(a),b.values.scrollEventsSinceLastRender+=1,b.values.scrollEventsSinceLastRender>b.options.forceRenderAfterScrollEventsCount&&(b.values.scrollEventsSinceLastRender=0,y.warn("direction "+b.values.direction),b.creepRenderModel.forceRenderNext()))}function l(){b.scrollModel.onScrollingStop()}function m(a){b.data[a-1]&&!b.isCompiled(a-1)&&b.forceRenderScope(a-1),b.data[a+1]&&!b.isCompiled(a+1)&&b.forceRenderScope(a+1)}function n(){C&&(y.log("onAfterHeightsUpdated force scroll to %s",b.values.scroll),j(b.values.scroll))}function o(){clearTimeout(r),y.destroyLogger(),p(),z&&(y.removeScrollListener(),y.removeTouchEvents()),y=null,b=null}var p,q,r,s,t,u,v,w,x,y=a.logWrapper("scrollModel",{},"orange",b),z=!1,A=!0,B=0,C=!1,D=0,E=0,F=0,G=[{event:"touchstart",method:"onTouchStart",enabled:!0},{event:"touchmove",method:"onTouchMove",enabled:!1},{event:"touchend",method:"onTouchEnd",enabled:!0},{event:"touchcancel",method:"onTouchEnd",enabled:!0}];return y.fireOnScroll=function(){b.values.scroll!==s&&(s=b.values.scroll,b.dispatch(a.datagrid.events.ON_SCROLL,b.values))},y.removeScrollListener=function(){y.log("removeScrollListener"),C=!1,b.element[0].removeEventListener("scroll",k)},y.removeTouchEvents=function(){if(z){y.log("removeTouchEvents");var c=b.getContent();a.each(G,function(a){y.log("\tremove %s",a.event),c[0].removeEventListener(a.event,y[a.method])})}},y.killEvent=function(a){a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.stopImmediatePropagation&&a.stopImmediatePropagation()},y.enable=function(a){A=!!a},y.onTouchStart=function(c){A&&(b.values.touchDown=!0,t=h(c)[0].clientY||0,u=h(c)[0].clientX||0,b.values.scroll<0?b.values.scroll=0:b.values.scroll>D&&(b.values.scroll=D),b.values.direction=0,v=0,w=0,b.dispatch(a.datagrid.events.ON_TOUCH_DOWN,c))},y.onTouchMove=function(c){if(A){b.options.scrollModel&&b.options.scrollModel.preventTouchMove&&y.killEvent(c);var d=Date.now();if(!(d-B<20)){B=d;var e=h(c)[0].clientY,f=h(c)[0].clientX,g=t-e,i=u-f;Math.abs(i)>Math.abs(g)||(t!==e&&(b.values.direction=g>0?1:-1,E=g,t=e,v=g),i!==w&&(F=i-w,w=i),b.dispatch(a.datagrid.events.ON_TOUCH_MOVE,E,g,v,F,i,w))}}},y.onTouchEnd=function(c){if(A&&b.values.touchDown){b.values.touchDown=!1,b.dispatch(a.datagrid.events.ON_TOUCH_UP,c),G[1].enabled?Math.abs(v)<2&&Math.abs(w)<2&&y.click(c):y.onUpdateScroll();var d=i();d<0||b.getContentHeight()<b.getViewportHeight()?j(0):d>b.getContentHeight()-b.getViewportHeight()&&j(b.getContentHeight()-b.getViewportHeight()),b.values.direction&&(b.creepRenderModel.forceRenderNext(),y.onUpdateScroll())}},y.click=function(a){if(b.options.scrollModel.simulateClick){var c,d=a.target;if(b.options.scrollModel.simulateClick&&d&&!/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)&&y.killEvent(a),!b.isDigesting(b.$scope)&&d&&!/(SELECT|INPUT|TEXTAREA)/i.test(d.tagName)){c=document.createEvent("MouseEvents"),c.initMouseEvent("click",!0,!0,a.view,1,d.screenX,d.screenY,d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),c._constructed=!0;try{b.creepRenderModel.stop(),d.dispatchEvent(c)}catch(a){}}}},y.getScroll=function(a){return a?a.scrollTop:i()},y.setScroll=function(a,c){y.warn("setScroll("+a+")");var d=b.chunkModel.getChunkList();b.data.length&&(!d||!d.height)&&c<20?b.flow.add(function(){y.setScroll(a,(c||0)+1)}):b.getContentHeight()-b.getViewportHeight()>=a&&(j(a),y.onUpdateScroll())},y.onUpdateScroll=function(c,d){var e,f=b.scrollModel.getScroll(c&&(c.target||c.srcElement));b.values.scroll===f&&b.element.scrollTop&&(e=b.element.scrollTop())!==f&&(f=e),b.values.scroll!==f?(b.dispatch(a.datagrid.events.ON_SCROLL_START,f),b.values.speed=f-b.values.scroll,b.values.absSpeed=Math.abs(b.values.speed),b.values.direction=f>b.values.scroll?1:f<b.values.scroll?-1:0,b.values.scroll=f,b.values.scrollPercent=(b.values.scroll/b.getContentHeight()*100).toFixed(2),b.scrollModel.waitForStop(d),y.fireOnScroll()):y.warn("skip fireOnScroll")},y.capScrollValue=function(a){var c;return b.getContentHeight()<b.getViewportHeight()?(y.log("\tCAPPED scroll value from %s to 0",a),a=0):b.getContentHeight()-a<b.getViewportHeight()&&(c=b.getContentHeight()-b.getViewportHeight(),y.log("\tCAPPED scroll value to keep it from scrolling past the bottom. changed %s to %s",a,c),a=c),a},y.scrollTo=function(a,c){return(a=y.capScrollValue(a))!==s&&(b.scrollModel.setScroll(a),c?b.scrollModel.onScrollingStop():b.scrollModel.waitForStop(),!0)},y.clearOnScrollingStop=function(){clearTimeout(r)},y.waitForStop=function(a){var c=a||!1;clearTimeout(r),q=!0,y.info("waitForStop scroll = %s",b.values.scroll),c||!b.flow.async&&!b.values.touchDown?l():r=setTimeout(l,b.options.updateDelay)},y.onScrollingStop=function(){q=!1,y.info("onScrollingStop %s",b.values.scroll),y.checkForEnds(),b.values.speed=0,b.values.absSpeed=0,b.values.direction=0,b.values.scrollEventsSinceLastRender=0,b.render(),y.fireOnScroll(),b.dispatch(a.datagrid.events.ON_SCROLL_STOP,b.values),y.calculateBottomOffset()},y.scrollToIndex=function(a,c){y.log("scrollToIndex");var d=b.getRowOffset(a);return b.scrollModel.scrollTo(d,c),d},y.scrollToItem=function(a,c){y.log("scrollToItem");var d=b.getNormalizedIndex(a);return-1!==d?b.scrollModel.scrollToIndex(d,c):b.values.scroll},y.scrollIntoView=function(a,c){y.log("scrollIntoView");var d,e,f="number"==typeof a?a:b.getNormalizedIndex(a),g=b.getRowOffset(f);return m(f),g<b.values.scroll?b.scrollModel.scrollTo(g,c):(b.updateViewportHeight(),e=b.getViewportHeight(),d=b.templateModel.getTemplateHeight(b.getData()[f]),g>=b.values.scroll+e-d&&b.scrollModel.scrollTo(g-e+d,c))},y.pageUp=function(){var a=b.getViewportHeight();b.values.scroll-a>0?b.scrollModel.scrollTo(b.values.scroll-a):b.scrollModel.scrollTo(0)},y.pageDown=function(){var a=b.getViewportHeight(),c=b.getContentHeight();b.values.scroll+a<c-a?b.scrollModel.scrollTo(b.values.scroll+a):b.scrollModel.scrollTo(c-a)},y.scrollToTop=function(a){y.log("scrollToTop"),b.scrollModel.scrollTo(0,a)},y.scrollToBottom=function(a){y.log("scrollToBottom");var c=b.getContentHeight()-b.getViewportHeight();b.scrollModel.scrollTo(c>=0?c:0,a)},y.calculateBottomOffset=function(){if(b.rowsLength){var a=b.rowsLength-1;y.bottomOffset=D=b.getRowOffset(a)-b.getViewportHeight()+b.getRowHeight(a)}},y.checkForEnds=function(){b.values.scroll&&b.values.scroll>=D?b.dispatch(a.datagrid.events.ON_SCROLL_TO_BOTTOM,b.values.speed):b.values.scroll<=0&&b.dispatch(a.datagrid.events.ON_SCROLL_TO_TOP,b.values.speed)},p=b.scope.$on(a.datagrid.events.ON_READY,c),b.unwatchers.push(b.scope.$on(a.datagrid.events.ON_AFTER_HEIGHTS_UPDATED,n)),b.unwatchers.push(b.scope.$on(a.datagrid.events.ON_BEFORE_RESET,e)),b.unwatchers.push(b.scope.$on(a.datagrid.events.ON_AFTER_RESET,f)),b.unwatchers.push(b.scope.$on(a.datagrid.events.ON_RENDER_AFTER_DATA_CHANGE,y.calculateBottomOffset)),y.destroy=o,b.scrollModel=y,b},a.datagrid.coreAddons.push(a.datagrid.coreAddons.scrollModel),a.datagrid.coreAddons.templateModel=function(b){"use strict";function c(a){return a=a.replace(/\n/g,""),a=a.replace(/[\t ]+</g,"<"),a=a.replace(/>[\t ]+</g,"><"),a=a.replace(/>[\t ]+$/g,">")}var d=/\#{3}[\w\d\W]+\#{3}/gi,f=/\#{3}include:([\w\d\W]+)\#{3}/gi,g=/uncompiled\s?/;return b.templateModel=function(){function h(){return M||(M="$$template_"+b.uid),M}function i(){Q.log("createTemplates");var c,d=b.element[0].getElementsByTagName("script"),e=d.length;for(e||O.length||b.throwError(a.errors.E1102),c=0;c<e;c+=1)j(d[c]);for(;d.length;)b.element[0].removeChild(d[0])}function j(a){var b=n(a,"template-name")||P,d=n(a,"template-base")||null,e=n(a,"template-item");return l(c(angular.element(a).html()),b,e,d)}function k(b){a.each(b,function(a){l(a.template,a.name,a.item,a.base)})}function l(d,e,f,g){var h,i=d,j=document.createElement("div");return j.className="grid-template-wrapper",d=Q.prepTemplate(e,d,g),d=angular.element(d)[0],g||(d.className+=" "+e+" "+b.options.rowClass+" "+b.options.uncompiledClass+" {{$status}}"),d.setAttribute("template",e),b.getContent()[0].appendChild(j),j.appendChild(d),d=c(j.innerHTML),h={name:e,item:f,template:d,originalTemplate:i,height:G(j.children[0])},Q.log("template: %s %o",e,h),h.height||("none"===b.element.css("display")?Q.warn("Datagrid was intialized with a display:'none' value. Templates are unable to calculate heights. Grid will not render correctly."):b.element[0].offsetHeight?b.throwError(a.errors.E1101):b.throwError(a.errors.E1000)),O[h.name]=h,O.push(h),b.getContent()[0].removeChild(j),L=0,h}function m(a,b,c){var e,h="";return c?(e=Q.getTemplateByName(c),h=e.originalTemplate,h=h.replace(new RegExp("#{3}"+a+"#{3}","gi"),b)):-1!==b.indexOf("###include:")?b.replace(f,function(a,b){var c=Q.getTemplateByName(b);return c&&c.template.replace(g,"")||""}):b.replace(d,"")}function n(a,b){var c=a.attributes["data-"+b]||a.attributes[b];return c&&c.value||""}function o(){return O}function p(a){return a.attr||a.getAttribute?a.attr?a.attr("template"):a.getAttribute("template"):a instanceof HTMLElement?void 0:a[h()]||a._template}function q(a){return O[a]?O[a]:O[P]}function r(){var b,c;for(b in O)if(a.util.apply(Object.prototype.hasOwnProperty,O,[b])&&(c=c||O[b].height)!==O[b].height)return!0;return!1}function s(){var a=0,b=O.length;if(!L)for(;a<b;)L+=O[a].height,a+=1;return L/b}function t(){return O.length}function u(a){var b=Q.getTemplate(a);return b?b.height:0}function v(a,b,c){var d=b,e=0;if(!a.length)return 0;for(;d<=c;)e+=Q.getRowHeight(d),d+=1;return e}function w(b,c){var d=h();a.util.apply(Object.prototype.hasOwnProperty,b,[d])||-1!==R.indexOf(b)||R.push(b),b[d]=c}function x(c,d,e){Q.info("setTemplate %s %s",c,d);var f;"number"==typeof c?(f=b.data[c],z(c)):f=c;var g=Q.getTemplate(f).name;Q.setTemplateName(f,d),b.flow.add(b.dispatch,[a.datagrid.events.ON_ROW_TEMPLATE_CHANGE,f,g,d,e],0)}function y(a,b){N[a]=b,S=!0}function z(a){delete N[a],S=!0}function A(){N={},S=!0}function B(a){return!!N[a]}function C(a){var c,d,e=N.hasOwnProperty(a),f=Q.getTemplateHeight(b.data[a]);if(T.variableRowHeights&&!e&&b.isCompiled(a)){if(!(c=b.getExistingRow(a))||!c.length)return f;(d=c[0].offsetHeight)!==N[a]&&d!==f&&(c[0].style.height=d+"px",N[a]=d,e=!0,S=!0)}return e?N[a]:f}function D(){return!!T.variableRowHeights}function E(){return S}function F(){S=!1}function G(a){var b=window.getComputedStyle(a);return a.offsetHeight+parseInt(b.marginTop,10)+parseInt(b.marginBottom,10)}function H(){for(var a,c,d,e=b.values.activeRange.min,f=b.values.activeRange.max-e,g={};e<f&&!S;)N.hasOwnProperty(e)||(Q.hasVariableRowHeights()?Q.getRowHeight(e):(c=Q.getTemplate(b.getData()[e]),g[c.name]||(a=b.getRowElm(e),(d=Q.calculateRowHeight(a[0]))!==c.height&&(c.height=d,S=!0)))),e+=1;S&&(b.updateHeights(),F())}function I(a){delete a[h()]}function J(){a.each(R,I),R.length=0}function K(){J(),Q.destroyLogger(),Q=null,O.length=0,O=null,R=null}var L,M,N,O=[],P="default",Q=a.logWrapper("templateModel",{},"teal",b),R=[],S=!1,T=e({},b.options.templateModel);return Q.getTemplate=function(a){var b=a[h()]||a._template;return Q.getTemplateByName(b)},Q.defaultName=P,Q.prepTemplate=m,Q.createTemplates=i,Q.createTemplatesFromData=k,Q.getTemplates=o,Q.getTemplateName=p,Q.getTemplateByName=q,Q.calculateRowHeight=G,Q.templateCount=t,Q.dynamicHeights=r,Q.averageTemplateHeight=s,Q.getHeight=v,Q.getTemplateHeight=u,Q.getRowHeight=C,Q.hasDirtyHeights=E,Q.clearDirtyHeights=F,Q.hasVariableRowHeights=D,Q.hasOverrideHeight=B,Q.forceRowHeight=y,Q.clearRowHeight=z,Q.clearAllRowHeights=A,Q.setTemplate=x,Q.setTemplateName=w,Q.updateTemplateHeights=H,Q.getTemplatesKey=h,Q.destroy=K,Q}(),b.templateModel},a.datagrid.coreAddons.push(a.datagrid.coreAddons.templateModel)}(this.ux=this.ux||{},function(){return this}());
//# sourceMappingURL=angular-ux-datagrid.min.js.map
}(this.ux = this.ux || {}, function() {return this;}()));
